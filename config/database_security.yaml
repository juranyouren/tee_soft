# æ•°æ®åº“å®‰å…¨é…ç½® - ç‹¬ç«‹åŠ å¯†ä½“ç³»
# ä¸é€šä¿¡åŠ å¯†å®Œå…¨éš”ç¦»çš„æ•°æ®åº“å®‰å…¨é…ç½®

# ğŸ” æ•°æ®åº“ç‹¬ç«‹åŠ å¯†é…ç½®
encryption:
  # ä¸»è¦åŠ å¯†ç®—æ³•
  algorithm: sm4-ecb
  key_size: 16  # 128ä½SM4å¯†é’¥
  block_size: 16
  
  # å®Œæ•´æ€§ä¿æŠ¤
  hash_algorithm: sm3
  integrity_check: mandatory
  
  # åŠ å¯†æ¨¡å¼
  mode: ecb  # ECBæ¨¡å¼ï¼ˆæ•°æ®åº“åœºæ™¯ï¼‰
  padding: pkcs7

# ğŸ—ï¸ ç‹¬ç«‹å¯†é’¥ç®¡ç†
key_management:
  # æ•°æ®åº“ä¸»å¯†é’¥
  db_master_key_env: DB_MASTER_KEY
  master_key_size: 16  # 128ä½
  
  # å¯†é’¥æ´¾ç”Ÿé…ç½®
  key_derivation:
    algorithm: sm3_based_hkdf
    derive_function: sm3_hash
    salt_source: purpose_based
    
    # å¯†é’¥æ´¾ç”Ÿå±‚æ¬¡
    hierarchy:
      level1: db_master_key
      level2: purpose_specific_key
      level3: feature_specific_key
  
  # æ”¯æŒçš„å­˜å‚¨ç”¨é€”
  storage_purposes:
    user_data:
      description: "ç”¨æˆ·åŸºç¡€æ•°æ®"
      key_suffix: "user_data"
      retention_days: 365
    
    risk_logs:
      description: "é£é™©è¯„ä¼°æ—¥å¿—"
      key_suffix: "risk_logs"
      retention_days: 730
    
    feature_history:
      description: "ç‰¹å¾å†å²è®°å½•"
      key_suffix: "feature_history"
      retention_days: 90
    
    statistics:
      description: "ç»Ÿè®¡æ•°æ®"
      key_suffix: "statistics"
      retention_days: 1095
    
    user_feature_device_fingerprint:
      description: "è®¾å¤‡æŒ‡çº¹ç‰¹å¾"
      key_suffix: "device_fingerprint"
      retention_days: 180
    
    user_feature_login_location:
      description: "ç™»å½•ä½ç½®ç‰¹å¾"
      key_suffix: "login_location"
      retention_days: 180
    
    user_feature_behavior_pattern:
      description: "è¡Œä¸ºæ¨¡å¼ç‰¹å¾"
      key_suffix: "behavior_pattern"
      retention_days: 90
  
  # å¯†é’¥è½®æ¢é…ç½®
  key_rotation:
    enabled: true
    rotation_days: 90
    advance_notice_days: 7
    overlap_period_days: 1
    backup_count: 3

# ğŸ›¡ï¸ æ•°æ®åº“å®‰å…¨ç­–ç•¥
security_policies:
  # æ•°æ®åˆ†ç±»
  data_classification:
    highly_sensitive: 
      - user_credentials
      - personal_identifiers
      - financial_data
    
    sensitive:
      - user_features
      - risk_scores
      - behavioral_data
    
    internal:
      - system_logs
      - performance_metrics
      - configuration_data
  
  # åŠ å¯†è¦æ±‚
  encryption_requirements:
    highly_sensitive: mandatory
    sensitive: mandatory
    internal: optional
  
  # è®¿é—®æ§åˆ¶
  access_control:
    encryption_key_access: tee_only
    decryption_authority: authorized_processes
    audit_requirements: comprehensive

# ğŸ”’ æ•°æ®å®Œæ•´æ€§é…ç½®
integrity:
  # å®Œæ•´æ€§ç®—æ³•
  algorithm: sm3
  verification_level: per_record
  
  # å®Œæ•´æ€§ä¿æŠ¤
  protection:
    hash_with_key: true
    timestamp_inclusion: true
    version_tracking: true
  
  # å®Œæ•´æ€§å¤±è´¥å¤„ç†
  failure_handling:
    action: reject_and_log
    escalation: security_team
    recovery: automatic_retry

# ğŸ“¦ æ•°æ®åº“è¡¨åŠ å¯†é…ç½®
table_encryption:
  # é£é™©æ—¥å¿—è¡¨
  risk_logs:
    encryption_level: full
    key_purpose: risk_logs
    integrity_check: per_row
    columns:
      encrypted_features: encrypted_blob
      risk_score: encrypted_decimal
      metadata: encrypted_json
  
  # ç”¨æˆ·ç‰¹å¾è¡¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
  user_features:
    encryption_level: full
    key_purpose: user_data
    integrity_check: per_row
    columns:
      feature_data: encrypted_blob
      feature_hash: integrity_hash
  
  # ç»Ÿè®¡æ•°æ®è¡¨
  statistics:
    encryption_level: selective
    key_purpose: statistics
    integrity_check: per_table
    columns:
      sensitive_stats: encrypted_blob
      public_stats: plaintext

# ğŸ”§ æ•°æ®åº“æ“ä½œé…ç½®
operations:
  # åŠ å¯†æ“ä½œ
  encryption:
    batch_size: 1000
    parallel_threads: 4
    memory_limit: 64MB
    timeout_seconds: 30
  
  # è§£å¯†æ“ä½œ
  decryption:
    cache_policy: no_cache
    memory_cleanup: immediate
    access_logging: mandatory
  
  # å¯†é’¥æ“ä½œ
  key_operations:
    derivation_cache_ttl: 0  # ä¸ç¼“å­˜æ´¾ç”Ÿå¯†é’¥
    secure_deletion: immediate
    operation_logging: detailed

# ğŸ“Š æ€§èƒ½ä¼˜åŒ–é…ç½®
performance:
  # åŠ å¯†æ€§èƒ½
  encryption_optimization:
    hardware_acceleration: true
    parallel_processing: true
    memory_optimization: true
  
  # æ•°æ®åº“æ€§èƒ½
  database_optimization:
    connection_pooling: true
    prepared_statements: true
    batch_operations: true
  
  # ç›‘æ§é…ç½®
  monitoring:
    encryption_latency: enabled
    throughput_tracking: enabled
    error_rate_monitoring: enabled

# ğŸš¨ å®‰å…¨ç›‘æ§é…ç½®
security_monitoring:
  # åŠ å¯†ç›‘æ§
  encryption_monitoring:
    key_usage_tracking: true
    encryption_patterns: true
    anomaly_detection: true
  
  # æ•°æ®åº“å®‰å…¨ç›‘æ§
  database_monitoring:
    unauthorized_access: alert
    integrity_violations: critical
    performance_anomalies: warning
  
  # å®¡è®¡æ—¥å¿—
  audit_logging:
    encryption_operations: detailed
    key_operations: comprehensive
    data_access: selective
    
    # æ—¥å¿—ä¿ç•™
    retention:
      encryption_logs: 1_year
      key_logs: 2_years
      access_logs: 90_days

# ğŸŒ åˆè§„æ€§é…ç½®
compliance:
  # å›½å¯†æ ‡å‡†åˆè§„
  national_standards:
    sm4_compliance: true
    sm3_compliance: true
    commercial_crypto_level: true
  
  # æ•°æ®ä¿æŠ¤åˆè§„
  data_protection:
    encryption_at_rest: mandatory
    key_isolation: enforced
    access_control: strict
  
  # å®¡è®¡è¦æ±‚
  audit_requirements:
    encryption_audit: comprehensive
    key_management_audit: detailed
    compliance_reporting: quarterly

# ğŸ”„ å¤‡ä»½å’Œæ¢å¤é…ç½®
backup_recovery:
  # åŠ å¯†å¤‡ä»½
  backup_encryption:
    algorithm: sm4-ecb
    key_source: independent
    integrity_protection: true
  
  # å¯†é’¥å¤‡ä»½
  key_backup:
    encryption: true
    location: secure_storage
    access_control: multi_factor
  
  # æ¢å¤é…ç½®
  recovery:
    key_recovery: automated
    data_verification: mandatory
    rollback_capability: true

# ğŸš€ éƒ¨ç½²é…ç½®
deployment:
  # ç¯å¢ƒé…ç½®
  environments:
    development:
      encryption_level: basic
      key_rotation: disabled
      monitoring: minimal
    
    staging:
      encryption_level: full
      key_rotation: weekly
      monitoring: standard
    
    production:
      encryption_level: maximum
      key_rotation: monthly
      monitoring: comprehensive
  
  # åˆå§‹åŒ–é…ç½®
  initialization:
    key_generation: automatic
    security_validation: mandatory
    performance_testing: required 